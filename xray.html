<!DOCTYPE html>
<html lang="zh-Hant">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
<meta name="apple-mobile-web-app-capable" content="yes">
<meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">

<title>吃飽沒測試掃描器</title>

<style>
*{ box-sizing:border-box; }

:root{
  --bg:#071821;
  --panel:#06131a;
  --text:#dff6ff;
  --muted:rgba(223,246,255,.72);
  --accent:#3bdcff;
  --accentText:#002733;
  --glow:rgba(59,220,255,.35);
  --grid:rgba(223,246,255,.06);
}

body{
  margin:0;
  background:var(--bg);
  color:var(--text);
  font-family:-apple-system,BlinkMacSystemFont,"PingFang TC","Noto Sans TC",sans-serif;
  text-align:center;
  transition: background .25s ease;
  overflow-x:hidden;
}

/* 全介面科技網格 + 雜訊 */
body::before{
  content:"";
  position:fixed;
  inset:0;
  background:
    linear-gradient(var(--grid) 1px, transparent 1px),
    linear-gradient(90deg, var(--grid) 1px, transparent 1px),
    radial-gradient(circle at 20% 15%, rgba(255,255,255,0.04), transparent 55%),
    radial-gradient(circle at 80% 35%, rgba(255,255,255,0.03), transparent 60%);
  background-size: 34px 34px, 34px 34px, auto, auto;
  pointer-events:none;
  opacity:.75;
}
body::after{
  content:"";
  position:fixed;
  inset:0;
  background: repeating-linear-gradient(
    to bottom,
    rgba(255,255,255,0.03) 0px,
    rgba(255,255,255,0.03) 1px,
    transparent 2px,
    transparent 6px
  );
  mix-blend-mode: overlay;
  opacity:.12;
  pointer-events:none;
}

/* 主題色（掃描完成後整體變色） */
.theme-blue{
  --bg:#071821; --panel:#06131a; --accent:#3bdcff; --accentText:#002733; --glow:rgba(59,220,255,.35);
}
.theme-green{
  --bg:#051b12; --panel:#04140d; --accent:#00ff88; --accentText:#002b19; --glow:rgba(0,255,136,.35);
}
.theme-yellow{
  --bg:#1a1606; --panel:#141104; --accent:#ffe066; --accentText:#2b2400; --glow:rgba(255,224,102,.35);
}
.theme-red{
  --bg:#1b0707; --panel:#140505; --accent:#ff4d4d; --accentText:#2b0000; --glow:rgba(255,77,77,.35);
}

/* Header */
header{
  padding:18px 14px 10px;
  border-bottom:1px solid rgba(255,255,255,0.08);
}
#appTitle{
  font-size:22px;
  font-weight:800;
  letter-spacing:1.5px;
}
#subtitle{
  margin-top:6px;
  font-size:12px;
  letter-spacing:.8px;
  color:var(--muted);
  text-transform:uppercase;
}

/* 版面：左右 HUD + 中央主體 */
#layout{
  width: 100%;
  max-width: 980px;
  margin: 0 auto;
  display:flex;
  justify-content:center;
  gap:16px;
  padding: 14px 12px 24px;
}

.hud{
  width: 190px;
  text-align:left;
  padding:12px 12px 14px;
  border-radius:16px;
  background: color-mix(in oklab, var(--panel) 88%, transparent);
  border:1px solid rgba(255,255,255,0.08);
  box-shadow: 0 10px 30px rgba(0,0,0,.30);
  position:relative;
  overflow:hidden;
}
.hud::before{
  content:"";
  position:absolute;
  inset:0;
  background: radial-gradient(circle at 30% 10%, rgba(255,255,255,0.06), transparent 55%);
  pointer-events:none;
}
.hud h3{
  margin:0 0 10px;
  font-size:12px;
  letter-spacing:1px;
  color:color-mix(in oklab, var(--accent) 75%, white 25%);
  text-transform:uppercase;
}
.hud .row{
  display:flex;
  justify-content:space-between;
  gap:8px;
  font-size:12px;
  padding:6px 0;
  border-bottom:1px dashed rgba(255,255,255,0.10);
}
.hud .row:last-child{ border-bottom:none; }
.k{ color:rgba(223,246,255,.70); }
.v{ font-variant-numeric: tabular-nums; }
.bar{
  height:6px;
  border-radius:999px;
  background: rgba(255,255,255,0.08);
  overflow:hidden;
  margin:8px 0 12px;
}
.bar > i{
  display:block;
  height:100%;
  width: 40%;
  background: color-mix(in oklab, var(--accent) 80%, white 20%);
  box-shadow: 0 0 18px var(--glow);
  animation: drift 2.6s ease-in-out infinite;
}
@keyframes drift{
  0%{ transform: translateX(-20%); width:36%; opacity:.7; }
  50%{ transform: translateX(40%); width:58%; opacity:1; }
  100%{ transform: translateX(-20%); width:36%; opacity:.7; }
}

#center{
  width:360px;
}

/* Scanner */
#scanner{
  width:330px; height:450px;
  margin: 8px auto 10px;
  border-radius:26px;
  border:2px solid var(--accent);
  position:relative;
  background:
    radial-gradient(circle at center, rgba(255,255,255,0.06), rgba(0,0,0,0.95));
  overflow:hidden;
  box-shadow:0 0 0 2px rgba(255,255,255,0.02), 0 18px 55px rgba(0,0,0,0.48);
  transition:border-color .25s ease;
}
#scannerCorners{
  position:absolute;
  inset:12px;
  border-radius:18px;
  border:1px solid rgba(255,255,255,0.10);
  pointer-events:none;
}
#scannerCorners::before, #scannerCorners::after{
  content:"";
  position:absolute;
  width:16px; height:16px;
  border:2px solid color-mix(in oklab, var(--accent) 80%, white 20%);
  opacity:.9;
}
#scannerCorners::before{ left:8px; top:8px; border-right:none; border-bottom:none; }
#scannerCorners::after{ right:8px; bottom:8px; border-left:none; border-top:none; }

#body{
  position:absolute;
  top:72px; left:50%;
  transform:translateX(-50%);
  width:185px; height:280px;
  border-radius:95px;
  border:2px dashed rgba(223,246,255,0.35);
}
#stomach{
  position:absolute;
  bottom:36px; left:50%;
  transform:translateX(-50%);
  width:130px; height:172px;
  border-radius:65px;
  background:color-mix(in oklab, var(--accent) 25%, transparent);
  transition: background .25s ease;
}

/* Scan line */
#scanline{
  position:absolute;
  top:-50px; left:0;
  width:100%; height:34px;
  background:linear-gradient(
    to bottom,
    transparent,
    color-mix(in oklab, var(--accent) 95%, white 5%),
    transparent
  );
  opacity:0;
  filter: blur(.2px);
}
.scanning #scanline{
  opacity:1;
  animation:scan linear;
}
@keyframes scan{
  from{ top:-50px; }
  to{ top:520px; }
}

/* 大按鈕（四區） */
#bigBtnWrap{
  width: 360px;
  margin: 10px auto 0;
  position:relative;
}
#bigBtn{
  width:100%;
  height:86px;
  border:none;
  border-radius:22px;
  background:var(--accent);
  color:var(--accentText);
  font-size:26px;
  font-weight:900;
  letter-spacing:1.5px;
  box-shadow:0 18px 48px rgba(0,0,0,0.38), 0 0 36px var(--glow);
  transition: background .25s ease, color .25s ease, box-shadow .25s ease;
}
#bigBtn[aria-disabled="true"]{ opacity:.45; }

.zone{
  position:absolute;
  top:0; height:86px;
  cursor:pointer;
  -webkit-tap-highlight-color: transparent;
  background:rgba(0,0,0,0);
}
#zoneHungry{ left:0;  width:10%; border-radius:22px 0 0 22px; }   /* 左 10% */
#zoneGreen{  left:10%; width:70%; }                               /* 中 70% */
#zoneYellow{ left:80%; width:20%; }                               /* 右 20% */
#zoneRed{    left:90%; width:10%; border-radius:0 22px 22px 0; }  /* 最右 10% */

/* 結果卡（大% + 跳動） */
#result{
  width:360px;
  margin:16px auto 22px;
  padding:14px 14px 16px;
  background: color-mix(in oklab, var(--panel) 90%, transparent);
  border:1px solid rgba(255,255,255,0.09);
  border-radius:18px;
  min-height:185px;
  box-shadow:0 10px 30px rgba(0,0,0,0.36);
}
#stateTitle{
  font-size:12px;
  color:var(--muted);
  letter-spacing:1px;
  text-transform:uppercase;
}

#bigPct{
  margin:12px 0 8px;
  font-size:74px;
  font-weight:950;
  letter-spacing:1px;
  line-height:1;
  color:var(--accent);
  text-shadow:0 0 28px var(--glow);
  transform:translateY(0);
}

.pop{ animation: pop .58s ease; }
@keyframes pop{
  0%   { transform:translateY(8px) scale(.96); opacity:.65; }
  55%  { transform:translateY(-8px) scale(1.035); opacity:1; }
  100% { transform:translateY(0) scale(1); opacity:1; }
}

#detail{
  font-size:18px;
  line-height:1.65;
}
.small{ font-size:14px; opacity:.74; }

/* 手機螢幕下左右 HUD 讓位：小於 860px 就收起來 */
@media (max-width: 860px){
  #layout{ gap:12px; }
  .hud{ display:none; }
  #center{ width: 100%; }
}
</style>
</head>

<body class="theme-blue">

<header>
  <div id="appTitle">吃飽沒測試掃描器</div>
  <div id="subtitle">SATIETY · XRAY · DIAGNOSTIC · MODULE</div>
</header>

<div id="layout">
  <!-- 左 HUD -->
  <aside class="hud" id="hudLeft">
    <h3>Telemetry</h3>
    <div class="bar"><i></i></div>
    <div class="row"><span class="k">SIG</span><span class="v" id="sig">—</span></div>
    <div class="row"><span class="k">NOI</span><span class="v" id="noi">—</span></div>
    <div class="row"><span class="k">TEMP</span><span class="v" id="temp">—</span></div>
    <div class="row"><span class="k">LAT</span><span class="v" id="lat">—</span></div>
    <div class="row"><span class="k">CLK</span><span class="v" id="clk">—</span></div>
  </aside>

  <!-- 中央 -->
  <main id="center">
    <div id="scanner">
      <div id="scanline"></div>
      <div id="scannerCorners"></div>
      <div id="body"></div>
      <div id="stomach"></div>
    </div>

    <div id="bigBtnWrap">
      <button id="bigBtn" aria-disabled="false">開始掃描</button>
      <div id="zoneHungry" class="zone" role="button" aria-label="掃描（幾乎沒吃）"></div>
      <div id="zoneGreen"  class="zone" role="button" aria-label="掃描（還可以吃）"></div>
      <div id="zoneYellow" class="zone" role="button" aria-label="掃描（快吃飽）"></div>
      <div id="zoneRed"    class="zone" role="button" aria-label="掃描（已吃飽）"></div>
    </div>

    <div id="result">
      <div id="stateTitle">狀態：待機</div>
      <div id="bigPct">--%</div>
      <div id="detail" class="small">請保持不動<br>系統準備中…</div>
    </div>
  </main>

  <!-- 右 HUD -->
  <aside class="hud" id="hudRight">
    <h3>Diagnostics</h3>
    <div class="bar"><i></i></div>
    <div class="row"><span class="k">CRC</span><span class="v" id="crc">—</span></div>
    <div class="row"><span class="k">BUF</span><span class="v" id="buf">—</span></div>
    <div class="row"><span class="k">THR</span><span class="v" id="thr">—</span></div>
    <div class="row"><span class="k">VLT</span><span class="v" id="vlt">—</span></div>
    <div class="row"><span class="k">MODE</span><span class="v" id="mode">—</span></div>
  </aside>
</div>

<script>
/* 元件 */
const scanner  = document.getElementById("scanner");
const scanline = document.getElementById("scanline");
const bigBtn   = document.getElementById("bigBtn");

const stateTitle = document.getElementById("stateTitle");
const bigPct     = document.getElementById("bigPct");
const detail     = document.getElementById("detail");

const zoneHungry = document.getElementById("zoneHungry");
const zoneGreen  = document.getElementById("zoneGreen");
const zoneYellow = document.getElementById("zoneYellow");
const zoneRed    = document.getElementById("zoneRed");

/* HUD 動態數據 */
const hud = {
  sig: document.getElementById("sig"),
  noi: document.getElementById("noi"),
  temp: document.getElementById("temp"),
  lat: document.getElementById("lat"),
  clk: document.getElementById("clk"),
  crc: document.getElementById("crc"),
  buf: document.getElementById("buf"),
  thr: document.getElementById("thr"),
  vlt: document.getElementById("vlt"),
  mode: document.getElementById("mode"),
};

let isScanning = false;

function randInt(min, max){
  return Math.floor(Math.random() * (max - min + 1)) + min;
}
function randFloat(min, max, dp=2){
  const v = Math.random() * (max - min) + min;
  return v.toFixed(dp);
}

function setTheme(theme){
  document.body.className = theme;
}
function setDisabled(disabled){
  bigBtn.setAttribute("aria-disabled", disabled ? "true" : "false");
  const pe = disabled ? "none" : "auto";
  zoneHungry.style.pointerEvents = pe;
  zoneGreen.style.pointerEvents  = pe;
  zoneYellow.style.pointerEvents = pe;
  zoneRed.style.pointerEvents    = pe;
}

/* % 跳動動畫（大字） */
function animatePercent(toValue){
  const fromValue = Math.max(0, toValue - randInt(14, 32));
  const duration = 600;
  const start = performance.now();

  bigPct.classList.remove("pop");
  void bigPct.offsetWidth;
  bigPct.classList.add("pop");

  function tick(now){
    const t = Math.min(1, (now - start) / duration);
    const eased = 1 - Math.pow(1 - t, 3);
    const current = Math.round(fromValue + (toValue - fromValue) * eased);
    bigPct.textContent = current + "%";
    if(t < 1) requestAnimationFrame(tick);
  }
  requestAnimationFrame(tick);
}

/* HUD：掃描中刷新更頻繁，掃描完停下來 */
let hudTimer = null;
function setHudMode(text){
  hud.mode.textContent = text;
}
function stopHud(){
  if(hudTimer) clearInterval(hudTimer);
  hudTimer = null;
}
function startHud(fast){
  stopHud();
  const interval = fast ? 180 : 600;
  hudTimer = setInterval(() => {
    hud.sig.textContent  = randInt(72, 99) + "%";
    hud.noi.textContent  = randInt(3, 18) + "dB";
    hud.temp.textContent = randFloat(33.0, 36.9, 1) + "°C";
    hud.lat.textContent  = randInt(6, 22) + "ms";
    const d = new Date();
    hud.clk.textContent  = d.toLocaleTimeString("zh-Hant", {hour12:false});

    hud.crc.textContent  = randInt(1000, 9999).toString(16).toUpperCase();
    hud.buf.textContent  = randInt(40, 96) + "%";
    hud.thr.textContent  = randInt(1, 7) + "." + randInt(0,9) + "x";
    hud.vlt.textContent  = randFloat(3.6, 4.2, 2) + "V";
  }, interval);
}

/* 主流程：四區掃描 */
function startScan(mode){
  if(isScanning) return;
  isScanning = true;

  // 掃描更久：4.2–5.6 秒
  const scanTime = randInt(4200, 5600);
  scanline.style.animationDuration = scanTime + "ms";

  setTheme("theme-blue");
  setDisabled(true);

  scanner.classList.add("scanning");
  stateTitle.textContent = "狀態：掃描中";
  bigPct.textContent = "--%";
  detail.className = "small";
  detail.innerHTML = "掃描中…<br>分析飽足狀態資料流…";

  setHudMode("SCAN");
  startHud(true);

  // 飽足範圍
  let fullness, themeAfter, titleAfter, messageHTML;

  if(mode === "hungry"){
    fullness   = randInt(25, 38);
    themeAfter = "theme-green";
    titleAfter = "狀態：幾乎沒吃";
    messageHTML = `
      <strong>系統判定：進食量偏低</strong><br>
      建議：可以正常吃<br>
      <span class="small">（先從主食／蛋白質開始）</span>
    `;
  } else if(mode === "green"){
    fullness   = randInt(55, 75);
    themeAfter = "theme-green";
    titleAfter = "狀態：尚有空間";
    messageHTML = `
      <strong>系統判定：尚有進食空間</strong><br>
      <strong>建議：再吃 3 口</strong><br>
      <span class="small">（蔬菜優先補充）</span>
    `;
  } else if(mode === "yellow"){
    fullness   = randInt(80, 90);
    themeAfter = "theme-yellow";
    titleAfter = "狀態：快吃飽";
    messageHTML = `
      <strong>系統判定：接近飽足</strong><br>
      建議：最後 1～2 口<br>
      <span class="small">（慢慢吃、先喝水）</span>
    `;
  } else {
    fullness   = randInt(92, 99);
    themeAfter = "theme-red";
    titleAfter = "狀態：已吃飽";
    messageHTML = `
      <strong>系統判定：已達飽足</strong><br>
      建議：停止進食<br>
      <span class="small">（可以收餐具／休息）</span>
    `;
  }

  setTimeout(() => {
    scanner.classList.remove("scanning");

    setTheme(themeAfter);
    stateTitle.textContent = titleAfter;
    animatePercent(fullness);

    detail.className = "";
    detail.innerHTML = messageHTML;

    setHudMode("HOLD");
    startHud(false);

    isScanning = false;
    setDisabled(false);
  }, scanTime);
}

/* 四區點擊 */
zoneHungry.addEventListener("click", () => startScan("hungry"));
zoneGreen.addEventListener("click",  () => startScan("green"));
zoneYellow.addEventListener("click", () => startScan("yellow"));
zoneRed.addEventListener("click",    () => startScan("red"));

/* 保險：點到按鈕本體也走綠區 */
bigBtn.addEventListener("click", () => {
  if(bigBtn.getAttribute("aria-disabled") === "true") return;
  startScan("green");
});

/* 初始：HUD 慢速跑 */
setHudMode("IDLE");
startHud(false);
</script>

</body>
</html>
